<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poetry OCR Tool</title>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<style>
  body{
    font-family: 'Nirmala UI', Arial, sans-serif;
    background: #f4f6f8;
    margin:0;
    padding:0;
  }
  .container{
    max-width:600px;
    margin:50px auto;
    background:#fff;
    padding:30px;
    border-radius:10px;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
  }
  h2{
    text-align:center;
    margin-bottom:20px;
    color:#333;
  }
  input[type="file"]{
    display:block;
    margin:20px auto;
  }
  button{
    display:block;
    width:100%;
    padding:12px;
    background:#4caf50;
    color:white;
    border:none;
    border-radius:6px;
    font-size:16px;
    cursor:pointer;
    margin-bottom:10px;
  }
  button:hover{
    background:#45a049;
  }
  textarea{
    width:100%;
    height:220px;
    padding:10px;
    margin-top:10px;
    border-radius:6px;
    border:1px solid #ccc;
    resize:none;
    font-size:16px;
    line-height:1.6;
  }
</style>
</head>
<body>

<div class="container">
  <h2>Poetry OCR Tool</h2>
  
  <input type="file" id="img" accept="image/*">
  
  <button onclick="readText()">Text Read Kare</button>
  <button onclick="copyText()">Copy Text</button>
  <button onclick="downloadText()">Download Text</button>
  
  <textarea id="output" placeholder="Yahan image ka text dikhega..."></textarea>
</div>

<script>
function readText(){
  const file = document.getElementById('img').files[0];
  if(!file){ alert("Image select karo"); return; }

  document.getElementById('output').value = "Reading text... Please wait";

  const reader = new FileReader();
  reader.onload = function(e){
    Tesseract.recognize(
      e.target.result,
      'eng+hin',
      { logger: m => console.log(m) }
    ).then(({ data: { text } }) => {
      let cleanText = cleanTextPoetry(text);
      document.getElementById('output').value = cleanText || "Text nahi mila";
    }).catch(err=>{
      alert("Kuch error aaya: "+err);
    });
  }
  reader.readAsDataURL(file);
}

// Hindi + English OCR cleaning, formatting preserve
function cleanTextPoetry(text){
  return text
    .replace(/[^\w\sऀ-ॿ.,…“”’'-]/g, '')  // unwanted symbols remove
    .replace(/\n\s*\n/g, '\n')           // extra blank lines remove
    .trim();
}

function copyText(){
  const text = document.getElementById('output').value;
  if(!text) return alert("Pehle text read karo");
  navigator.clipboard.writeText(text);
  alert("Text copied!");
}

function downloadText(){
  const text = document.getElementById('output').value;
  if(!text) return alert("Pehle text read karo");

  const blob = new Blob([text], {type: "text/plain"});
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "poetry_text.txt";
  link.click();
}
</script>

</body>
</html>
